```r
Gauss_elimination <- function(m){
    n <- ncol(m); m <- cbind(m, diag(n))
    #Upper triangle
    for(i in 2:n){
        if(m[i - 1, i -1] == 0){
            next
        }
        m[i - 1, ] <- m[i - 1, ]/m[i - 1, i - 1]
        m[i:n, ] <- m[i:n, ] - 
            matrix(rep(m[i - 1, ], n - i + 1), ncol=2*n, byrow=T)*m[i:n, i - 1]
    }
    #Adjust last equation
    m[n, ] <- m[n, ]/m[n, n]
    #Diagonal
    for(j in (n - 1):1){
        m[1:j, ] <- m[1:j, ] - 
            matrix(rep(m[j + 1, ], j), ncol=2*n, byrow=T)*m[1:j, j + 1]
    }
    m[, (n + 1):(2*n)]
}
```
```r
A <- matrix(c(1.1, 2.2, -1.1, 0, 0.51, 1.01, 0, 1.01, 0, 2.01, -0.51, 1.51, 1, -1, 1.5, 0), ncol=4, byrow=T)
A
```
```
     [,1]  [,2]  [,3] [,4]
[1,] 1.10  2.20 -1.10 0.00
[2,] 0.51  1.01  0.00 1.01
[3,] 0.00  2.01 -0.51 1.51
[4,] 1.00 -1.00  1.50 0.00
```
```r
Inv_A <- Gauss_elimination(A)
Inv_A
```
```
           [,1]      [,2]      [,3]       [,4]
[1,]  0.1752534  2.401781 -1.606490 -0.4176873
[2,]  0.4627514 -3.002227  2.008112  1.0221091
[3,]  0.1916653 -3.602672  2.409734  1.6265309
[4,] -0.5512457  2.779545 -1.196914 -0.8111977
```

```r
solve(A)
```
```
           [,1]      [,2]      [,3]       [,4]
[1,]  0.1752534  2.401781 -1.606490 -0.4176873
[2,]  0.4627514 -3.002227  2.008112  1.0221091
[3,]  0.1916653 -3.602672  2.409734  1.6265309
[4,] -0.5512457  2.779545 -1.196914 -0.8111977
```
